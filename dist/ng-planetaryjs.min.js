/** 
* @license ng-planetaryjs - v0.0.6
* (c) 2013 Julien VALERY https://github.com/darul75/ng-planetaryjs
* License: MIT 
**/
!function(a){"use strict";a.module("ngPlanetaryJs",[]).directive("planetaryjs",[function(){return{restrict:"AE",scope:{options:"="},link:function(a,b){function c(a){return function(b){var c=null,d=!1;b.plugins.autorotate={pause:function(){d=!0},resume:function(){d=!1}},b.onDraw(function(){if(d||!c)c=new Date;else{var e=new Date,f=e-c,g=b.projection.rotate();g[0]+=a*f/1e3,g[0]>=180&&(g[0]-=360),b.projection.rotate(g),c=e}})}}var d=b[0],e=d.width/2,f=planetaryjs.planet(),g=a.options.plugins;f.loadPlugin(planetaryjs.plugins.earth(g.earth)),g.pings&&f.loadPlugin(planetaryjs.plugins.pings(g.pings)),g.zoom&&f.loadPlugin(planetaryjs.plugins.zoom(g.zoom)),g.autorotate&&g.autorotate.degree&&f.loadPlugin(c(g.autorotate.degree)),f.loadPlugin(planetaryjs.plugins.drag()),f.projection.scale(e).translate([e,e]).rotate([0,-10,0]),2==window.devicePixelRatio&&(d.width=2*d.width,d.height=2*d.height,context=d.getContext("2d"),context.scale(2,2));var h=function(){f.draw(d)},i=function(){f.stop()};h();var j,k=function(a,b,c){f.plugins.pings&&f.plugins.pings.add(a,b,c)};b.on("$destroy",function(){i(),j=!0}),a.$on("add-ping",function(a,b){k(b.lng,b.lat,b.config)}),a.$on("planet-stop",function(){j||(i(),j=!j)}),a.$on("planet-start",function(){j&&(h(),j=!j)})}}}])}(angular);